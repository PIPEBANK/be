1. 방화벽 설정(생략)
	ufw allow http
	ufw allow https
	ufw allow ftp
	ufw allow ssh

2. 아파치 설치
	apt-get install apache2

3. 톰캣8 설치
	apt-get install tomcat8

4. mod-jk 설치
	apt-get install libapache2-mod-jk

5. workers.properties 생성
(5-1) workers.properties 생성
	vi /etc/apache2/workers.properties

(5-2)workers.properties 내용수정 [편집모드 i , 한줄삭제 d] 
ps=\
worker.list=name
worker.name.port = 8009
worker.name.host = localhost
worker.name.type = ajp13
worker.name.lbfactor = 1

6.jk.conf 수정

(6-1) jk.conf 수정
	vi /etc/apache2/mods-available/jk.conf 

(6-2) jk.conf 내용수정 [편집모드 i , 한줄삭제 d] 
	이전 : JkWorkersFile /etc/libapache2-mod-jk/workers.properties
	변경 : JkWorkersFile /etc/apache2/workers.properties

7. 000-default.conf 파일 수정
(7-1)000-default.conf 파일 수정
	vi /etc/apache2/sites-available/000-default.conf

(7-2) 000-default.conf 내용수정 [편집모드 i , 한줄삭제 d] 
<VirtualHost *:80>
ServerAdmin webmaster@localhost
DocumentRoot /web/www/ROOT
	JkMount /* www
ErrorLog ${APACHE_LOG_DIR}/error.log
	LogLevel warn
CustomLog ${APACHE_LOG_DIR}/access.log combined
	ServerName www.nalmada.co.kr
	ServerAlias www.nalmada.co.kr
</VirtualHost>
#vim: syntax=apache ts=4 sw=4 sts=4 sr noet


8. server.xml 파일 수정
(8-1)server.xml 파일 수정
vi /etc/tomcat8/server.xml

(8-2) server.xml 내용수정 [편집모드 i , 한줄삭제 d] 
<?xml version='1.0' encoding='utf-8'?>
<Server port="8005" shutdown="SHUTDOWN">
<Listener className="org.apache.catalina.startup.VersionLoggerListener" />
<Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />
<Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />
<Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" />
<GlobalNamingResources>
<Resource name="UserDatabase" auth="Container"
type="org.apache.catalina.UserDatabase"
description="User database that can be updated and saved"
factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
pathname="conf/tomcat-users.xml" />
</GlobalNamingResources>

<Service name="Catalina">
<Connector port="8080" protocol="HTTP/1.1"
connectionTimeout="20000"
URIEncoding="UTF-8"
redirectPort="8443" />
<Connector port="8009" protocol="AJP/1.3" redirectPort="8443" URIEncoding="UTF-8"/>
<Engine name="Catalina" defaultHost="localhost">
<Realm className="org.apache.catalina.realm.LockOutRealm">
<Realm className="org.apache.catalina.realm.UserDatabaseRealm" resourceName="UserDatabase"/>
</Realm>
<Host name="localhost" appBase="/web/www" unpackWARs="true" autoDeploy="true" 
xmlValidation="false" xmlNamespaceAware="false">
</Host>
</Engine>
</Service>
</Server>

9. 아파치 , 톰캣 재시작
	service apache2 restart
	service tomcat8 restart




10. 폴더 생성
#프로그램 폴더 생성 및 설치
mkdir -p /web/www/ROOT
mkdir -p /web/uploads
chown -R tomcat8:tomcat8 /web/uploads/
	#/web/www/ROOT/ 경로에 프로그램(ROOT.war) 복사

#압축 파일 포맷 압축해제 기능 
	apt install default-jdk




--------- mysql 설치 및 환경 설정 -------------
1.my-sql 설치
	apt-get install mysql-server

2.mysql 설정

mysql -u root -p
use mysql;
create user 'root'@'%' identified by '(DB root 암호)';
grant all privileges on *.* to 'root'@'%';
flush privileges;
select user,host,grant_priv from user where user='root' and host='%';
update user set grant_priv='Y' where user='root' and host='%';
flush privileges;
exit


3.mysql 환경설정 편집

(3-1) [mysqld] 수정
	vi /etc/mysql/mysql.conf.d/mysqld.cnf

[mysqld] 에 추가
character-set-client-handshake=false
init_connect="SET collation_connection=utf8_general_ci"
init_connect="SET NAMES utf8"
character-set-server=utf8
collation-server=utf8_general_ci
lower_case_table_names=1
bind-address = 127.0.0.1 주석처리[맨앞 #추가]

*맨마지막줄에추가( mysql에서 테이블 AS 설정 에러 해결)
sql_mode 
="STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION“
* 한줄로 작성 엔터치면 에러발생.

(3-2) [mysql] 수정
vi /etc/mysql/conf.d/mysql.cnf

[mysql] 에 추가
default-character-set=utf8

재시작
sudo /etc/init.d/mysql restart

server.xml [원본]
<?xml version='1.0' encoding='utf-8'?>
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements. See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License. You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!-- Note: A "Server" is not itself a "Container", so you may not
define subcomponents such as "Valves" at this level.
Documentation at /docs/config/server.html
-->
<Server port="8005" shutdown="SHUTDOWN">
<Listener className="org.apache.catalina.startup.VersionLoggerListener" />
<!-- Security listener. Documentation at /docs/config/listeners.html
<Listener className="org.apache.catalina.security.SecurityListener" />
-->
<!--APR library loader. Documentation at /docs/apr.html -->
<!--
<Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" />
-->
<!-- Prevent memory leaks due to use of particular java/javax APIs-->
<Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />
<Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />
<Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" />
<!-- Global JNDI resources
Documentation at /docs/jndi-resources-howto.html
-->
<GlobalNamingResources>
<!-- Editable user database that can also be used by
UserDatabaseRealm to authenticate users
-->
<Resource name="UserDatabase" auth="Container"
type="org.apache.catalina.UserDatabase"
description="User database that can be updated and saved"
factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
pathname="conf/tomcat-users.xml" />
</GlobalNamingResources>
<!-- A "Service" is a collection of one or more "Connectors" that share
a single "Container" Note: A "Service" is not itself a "Container",
so you may not define subcomponents such as "Valves" at this level.
Documentation at /docs/config/service.html
-->
<Service name="Catalina">
<!--The connectors can use a shared executor, you can define one or more named thread pools-->
<!--
<Executor name="tomcatThreadPool" namePrefix="catalina-exec-"
maxThreads="150" minSpareThreads="4"/>
-->
<!-- A "Connector" represents an endpoint by which requests are received
and responses are returned. Documentation at :
Java HTTP Connector: /docs/config/http.html (blocking & non-blocking)
Java AJP Connector: /docs/config/ajp.html
APR (HTTP/AJP) Connector: /docs/apr.html
Define a non-SSL/TLS HTTP/1.1 Connector on port 8080
-->
<Connector port="8080" protocol="HTTP/1.1"
connectionTimeout="20000"
URIEncoding="UTF-8"
redirectPort="8443" />
<!-- A "Connector" using the shared thread pool-->
<!--
<Connector executor="tomcatThreadPool"
port="8080" protocol="HTTP/1.1"
connectionTimeout="20000"
redirectPort="8443" />
-->
<!-- Define a SSL/TLS HTTP/1.1 Connector on port 8443
This connector uses the NIO implementation that requires the JSSE
style configuration. When using the APR/native implementation, the
OpenSSL style configuration is required as described in the APR/native
documentation -->
<!--
<Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
clientAuth="false" sslProtocol="TLS" />
-->
<!-- Define an AJP 1.3 Connector on port 8009 -->
<!--
<Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />
-->
<!-- An Engine represents the entry point (within Catalina) that processes
every request. The Engine implementation for Tomcat stand alone
analyzes the HTTP headers included with the request, and passes them
on to the appropriate Host (virtual host).
Documentation at /docs/config/engine.html -->
<!-- You should set jvmRoute to support load-balancing via AJP ie :
<Engine name="Catalina" defaultHost="localhost" jvmRoute="jvm1">
-->
<Engine name="Catalina" defaultHost="localhost">
<!--For clustering, please take a look at documentation at:
/docs/cluster-howto.html (simple how to)
/docs/config/cluster.html (reference documentation) -->
<!--
<Cluster className="org.apache.catalina.ha.tcp.SimpleTcpCluster"/>
-->
<!-- Use the LockOutRealm to prevent attempts to guess user passwords
via a brute-force attack -->
<Realm className="org.apache.catalina.realm.LockOutRealm">
<!-- This Realm uses the UserDatabase configured in the global JNDI
resources under the key "UserDatabase". Any edits
that are performed against this UserDatabase are immediately
available for use by the Realm. -->
<Realm className="org.apache.catalina.realm.UserDatabaseRealm"
resourceName="UserDatabase"/>
</Realm>
<Host name="localhost" appBase="webapps"
unpackWARs="true" autoDeploy="true">
<!-- SingleSignOn valve, share authentication between web applications
Documentation at: /docs/config/valve.html -->
<!--
<Valve className="org.apache.catalina.authenticator.SingleSignOn" />
-->
<!-- Access log processes all example.
Documentation at: /docs/config/valve.html
Note: The pattern used is equivalent to using pattern="common" -->
<Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
prefix="localhost_access_log" suffix=".txt"
pattern="%h %l %u %t &quot;%r&quot; %s %b" />
</Host>
</Engine>
</Service>
</Server>
